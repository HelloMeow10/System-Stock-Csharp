@page "/stock"
@using Microsoft.FluentUI.AspNetCore.Components
@inject BusinessLogic.Services.IStockService StockService

<PageTitle>Stock</PageTitle>

<div style="padding: 20px;">
    <h1>Stock Actual</h1>

    @if (stockItems == null)
    {
        <FluentProgressRing />
    }
    else if (!stockItems.Any())
    {
        <p>No hay items en stock.</p>
    }
    else
    {
        <FluentDataGrid Items="@stockItems.AsQueryable()" ResizableColumns="true" Pagination="@pagination">
            <PropertyColumn Property="@(p => p.Product)" Title="Producto" Sortable="true" />
            <PropertyColumn Property="@(p => p.Warehouse)" Title="AlmacÃ©n" Sortable="true" />
            <PropertyColumn Property="@(p => p.Quantity)" Title="Cantidad" Sortable="true" />
        </FluentDataGrid>
        <FluentPaginator State="@pagination" />
    }
</div>

@code {
    private IEnumerable<Contracts.StockItemDto>? stockItems;
    private PaginationState pagination = new PaginationState { ItemsPerPage = 20 };

    protected override async Task OnInitializedAsync()
    {
        try
        {
            stockItems = await StockService.GetStockAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading stock: {ex.Message}");
        }
    }
}
